{
  "updatedAt": "2025-09-25T06:31:52.000Z",
  "createdAt": "2025-09-25T03:45:37.426Z",
  "id": "Ad3vIyzypYTv0Ii4",
  "name": "Batch Image OCR Pipeline",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "formTitle": "ä¸Šä¼ å›¾ç‰‡",
        "formFields": {
          "values": [
            {
              "fieldLabel": "images",
              "fieldType": "file",
              "acceptFileTypes": ".jpg,.png"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -256,
        64
      ],
      "id": "1baa32c7-9116-4d12-b4a2-31c3a28d74bc",
      "name": "Batch Image Upload",
      "webhookId": "b2c44ad4-75e5-462d-980b-35db11060745"
    },
    {
      "parameters": {
        "jsCode": "let results = [];\nfor (const item of $input.all()) {\n    // è·å– binary ä¸­çš„æ‰€æœ‰æ–‡ä»¶\n    for (const [key, binaryData] of Object.entries(item.binary)) {\n        results.push({\n            json: {\n                ...item.json,\n                currentFile: key, // æ·»åŠ å½“å‰å¤„ç†çš„æ–‡ä»¶æ ‡è¯†\n                filename: binaryData.fileName || key,\n                fileSize: binaryData.fileSize\n            },\n            binary: { \n                data: binaryData  // åªåŒ…å«å½“å‰æ–‡ä»¶çš„ binary æ•°æ®\n            }\n        });\n    }\n}\nreturn results;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -16,
        64
      ],
      "id": "ec688e26-0a5d-4b89-843c-d0554b471709",
      "name": "Split Files to Items"
    },
    {
      "parameters": {
        "content": "### å°†å¤šä¸ªæ–‡ä»¶åˆ†å‰²æˆç‹¬ç«‹çš„ items \n",
        "height": 240,
        "width": 280,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -96,
        0
      ],
      "id": "829c0ce4-8992-4bd7-9130-ed7ae4fae565",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?AIzaSyAM0vr_jkKGBzSQWvQOLTe5bn5t17DIAVE",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"è¯·æå–å›¾ç‰‡ä¸­çš„å…¨éƒ¨æ–‡æœ¬å†…å®¹ï¼Œä¸¥æ ¼ä¿æŒåŸæœ‰æ ¼å¼å’Œæ’ç‰ˆã€‚è¦æ±‚ï¼šä¿æŒåŸå§‹çš„è¡Œé—´è·ã€æ®µè½ç»“æ„å’Œç¼©è¿›ï¼Œä¿ç•™è¡¨æ ¼ã€åˆ—è¡¨ç­‰ç‰¹æ®Šæ ¼å¼ï¼Œä¸æ·»åŠ ä»»ä½•è§£é‡Šã€è¯´æ˜æˆ–é¢å¤–ç¬¦å·ï¼Œå¦‚é‡ä¸æ¸…æ™°æ–‡å­—ç”¨[?]æ ‡è®°ï¼Œç›´æ¥è¾“å‡ºæå–ç»“æœæ— éœ€å‰è¨€åè¯­ã€‚\"\n        },\n        {\n          \"inline_data\": {\n            \"mime_type\": \"image/jpeg\",\n            \"data\": \"{{ $('Convert to Base64').item.json.data }}\"\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 1,\n    \"maxOutputTokens\": 65536\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1008,
        64
      ],
      "id": "2b3d56d0-7474-4cff-9090-adc208194d4c",
      "name": "Gemini OCR API"
    },
    {
      "parameters": {
        "content": "## ğŸ“‹ æ‰¹é‡ OCR å¤„ç†æµç¨‹\nğŸ”„ å¯¹æ¯å¼ ä¸Šä¼ çš„å›¾ç‰‡æ‰§è¡Œï¼š\n1. è½¬æ¢ä¸º Base64 æ ¼å¼\n2. å‘é€è‡³ Google Gemini API\n3. è¯†åˆ«å¹¶æå–æ–‡æœ¬å†…å®¹\n4. æ”¶é›† OCR ç»“æœåŒæ­¥åˆ°é£ä¹¦å¤šç»´è¡¨æ ¼\n\nğŸ’¡ å¾ªç¯ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶\n\n",
        "height": 480,
        "width": 1240,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        224,
        -160
      ],
      "id": "c5082588-8ebf-44d2-a8a1-445167d54cff",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "options": {
          "keepSource": "both"
        }
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        608,
        64
      ],
      "id": "37f2c87a-73a0-4169-a50a-0d7d10e69527",
      "name": "Convert to Base64"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [
        1248,
        64
      ],
      "id": "80558502-6de3-4eaa-8831-983a549b0ec4",
      "name": "Save to Feishu Sheet"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        304,
        64
      ],
      "id": "9caab7b3-a696-4541-bfb2-457a732f7560",
      "name": "Process Each Image"
    },
    {
      "parameters": {
        "resource": "space",
        "operation": "space:upload",
        "parent_type": "bitable_image"
      },
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [
        816,
        64
      ],
      "id": "034df1ab-e63a-4408-9794-2876fea1f1c9",
      "name": "Upload to Feishu Drive",
      "credentials": {
        "feishuCredentialsApi": {
          "id": "molPXxlxixSejC8i",
          "name": "Feishu Credentials account"
        }
      }
    }
  ],
  "connections": {
    "Batch Image Upload": {
      "main": [
        [
          {
            "node": "Split Files to Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Files to Items": {
      "main": [
        [
          {
            "node": "Process Each Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Each Image": {
      "main": [
        [],
        [
          {
            "node": "Convert to Base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload to Feishu Drive": {
      "main": [
        [
          {
            "node": "Gemini OCR API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to Base64": {
      "main": [
        [
          {
            "node": "Upload to Feishu Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "e84bc757-6bd0-47c0-9ff1-cfece03b6655",
  "activeVersionId": null,
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2025-09-25T03:45:37.433Z",
      "createdAt": "2025-09-25T03:45:37.433Z",
      "role": "workflow:owner",
      "workflowId": "Ad3vIyzypYTv0Ii4",
      "projectId": "SETuOI0q3TN4aDy1"
    }
  ],
  "activeVersion": null,
  "tags": [
    {
      "updatedAt": "2025-09-25T03:47:37.843Z",
      "createdAt": "2025-09-25T03:47:37.843Z",
      "id": "dACoE8y3CFFnPq4e",
      "name": "OCR"
    },
    {
      "updatedAt": "2025-09-25T03:47:37.838Z",
      "createdAt": "2025-09-25T03:47:37.838Z",
      "id": "qqmi8By0ccSVRUHm",
      "name": "Gemini"
    }
  ]
}